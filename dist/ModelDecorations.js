"use strict";
require('reflect-metadata');
var _ = require('lodash');
var Log = require('./log');
var Manager_1 = require('./Manager');
var log = Log.create('ModelDecorations');
var defaultTableOptions = {
    writeThroughput: 5,
    readThroughput: 10
};
function setDefaultTableOptions(newTableOptions) {
    defaultTableOptions = newTableOptions;
}
exports.setDefaultTableOptions = setDefaultTableOptions;
/**
 * Decorate a specified class, making it a
 * PersistableModel
 *
 * Set process.env.DYNO_SKIP to true in order to skip
 * decorations - useful in dual purpose classes,
 * in webpack use DefinePlugin
 */
function ModelDescriptor(opts) {
    if (!process.env.DYNO_SKIP) {
        return function (constructor) {
            // Make sure everything is valid
            _.defaults(opts, defaultTableOptions, {
                clazzName: constructor.name
            });
            log.debug('Decorating: ', opts.clazzName);
            Manager_1.Manager.registerModel(opts.clazzName, constructor, opts);
        };
    }
}
exports.ModelDescriptor = ModelDescriptor;
function AttributeDescriptor(opts) {
    return function (target, propertyKey) {
        Manager_1.Manager.registerAttribute(target, propertyKey, opts);
    };
}
exports.AttributeDescriptor = AttributeDescriptor;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIk1vZGVsRGVjb3JhdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLFFBQU8sa0JBRVAsQ0FBQyxDQUZ3QjtBQUV6QixJQUFZLENBQUMsV0FBTSxRQUNuQixDQUFDLENBRDBCO0FBQzNCLElBQVksR0FBRyxXQUFNLE9BRXJCLENBQUMsQ0FGMkI7QUFFNUIsd0JBQXNCLFdBQ3RCLENBQUMsQ0FEZ0M7QUFHakMsSUFBTSxHQUFHLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFBO0FBRzFDLElBQUksbUJBQW1CLEdBQWlCO0lBQ3ZDLGVBQWUsRUFBRSxDQUFDO0lBQ2xCLGNBQWMsRUFBRSxFQUFFO0NBQ2xCLENBQUE7QUFHRCxnQ0FBdUMsZUFBNkI7SUFDbkUsbUJBQW1CLEdBQUcsZUFBZSxDQUFBO0FBQ3RDLENBQUM7QUFGZSw4QkFBc0IseUJBRXJDLENBQUE7QUFFRDs7Ozs7OztHQU9HO0FBQ0gseUJBQWdDLElBQWtCO0lBQ2pELEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO1FBSTVCLE1BQU0sQ0FBQyxVQUFTLFdBQW9CO1lBQ25DLGdDQUFnQztZQUNoQyxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksRUFBQyxtQkFBbUIsRUFBQztnQkFDbkMsU0FBUyxFQUFHLFdBQW1CLENBQUMsSUFBSTthQUNwQyxDQUFDLENBQUE7WUFHRixHQUFHLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUE7WUFDekMsaUJBQU8sQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBQyxXQUFXLEVBQUMsSUFBcUIsQ0FBQyxDQUFBO1FBQ3hFLENBQUMsQ0FBQTtJQUVGLENBQUM7QUFDRixDQUFDO0FBakJlLHVCQUFlLGtCQWlCOUIsQ0FBQTtBQUlELDZCQUFvQyxJQUF1QjtJQUUxRCxNQUFNLENBQUMsVUFBVSxNQUFVLEVBQUMsV0FBa0I7UUFDN0MsaUJBQU8sQ0FBQyxpQkFBaUIsQ0FBQyxNQUFNLEVBQUMsV0FBVyxFQUFDLElBQUksQ0FBQyxDQUFBO0lBQ25ELENBQUMsQ0FBQTtBQUdGLENBQUM7QUFQZSwyQkFBbUIsc0JBT2xDLENBQUEiLCJmaWxlIjoiTW9kZWxEZWNvcmF0aW9ucy5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW1wb3J0ICdyZWZsZWN0LW1ldGFkYXRhJ1xuXG5pbXBvcnQgKiBhcyBfIGZyb20gJ2xvZGFzaCdcbmltcG9ydCAqIGFzIExvZyBmcm9tICcuL2xvZydcblxuaW1wb3J0IHtNYW5hZ2VyfSBmcm9tICcuL01hbmFnZXInXG5pbXBvcnQge0lUYWJsZU9wdGlvbnMsSU1vZGVsT3B0aW9ucyxJQXR0cmlidXRlT3B0aW9uc30gZnJvbSAnLi9UeXBlcydcblxuY29uc3QgbG9nID0gTG9nLmNyZWF0ZSgnTW9kZWxEZWNvcmF0aW9ucycpXG5cblxubGV0IGRlZmF1bHRUYWJsZU9wdGlvbnM6SVRhYmxlT3B0aW9ucyA9IHtcblx0d3JpdGVUaHJvdWdocHV0OiA1LFxuXHRyZWFkVGhyb3VnaHB1dDogMTBcbn1cblxuXG5leHBvcnQgZnVuY3Rpb24gc2V0RGVmYXVsdFRhYmxlT3B0aW9ucyhuZXdUYWJsZU9wdGlvbnM6SVRhYmxlT3B0aW9ucykge1xuXHRkZWZhdWx0VGFibGVPcHRpb25zID0gbmV3VGFibGVPcHRpb25zXG59XG5cbi8qKlxuICogRGVjb3JhdGUgYSBzcGVjaWZpZWQgY2xhc3MsIG1ha2luZyBpdCBhXG4gKiBQZXJzaXN0YWJsZU1vZGVsXG4gKlxuICogU2V0IHByb2Nlc3MuZW52LkRZTk9fU0tJUCB0byB0cnVlIGluIG9yZGVyIHRvIHNraXBcbiAqIGRlY29yYXRpb25zIC0gdXNlZnVsIGluIGR1YWwgcHVycG9zZSBjbGFzc2VzLFxuICogaW4gd2VicGFjayB1c2UgRGVmaW5lUGx1Z2luXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBNb2RlbERlc2NyaXB0b3Iob3B0czpJTW9kZWxPcHRpb25zKSB7XG5cdGlmICghcHJvY2Vzcy5lbnYuRFlOT19TS0lQKSB7XG5cblxuXG5cdFx0cmV0dXJuIGZ1bmN0aW9uKGNvbnN0cnVjdG9yOkZ1bmN0aW9uKSB7XG5cdFx0XHQvLyBNYWtlIHN1cmUgZXZlcnl0aGluZyBpcyB2YWxpZFxuXHRcdFx0Xy5kZWZhdWx0cyhvcHRzLGRlZmF1bHRUYWJsZU9wdGlvbnMse1xuXHRcdFx0XHRjbGF6ek5hbWU6IChjb25zdHJ1Y3RvciBhcyBhbnkpLm5hbWVcblx0XHRcdH0pXG5cblxuXHRcdFx0bG9nLmRlYnVnKCdEZWNvcmF0aW5nOiAnLCBvcHRzLmNsYXp6TmFtZSlcblx0XHRcdE1hbmFnZXIucmVnaXN0ZXJNb2RlbChvcHRzLmNsYXp6TmFtZSxjb25zdHJ1Y3RvcixvcHRzIGFzIElNb2RlbE9wdGlvbnMpXG5cdFx0fVxuXG5cdH1cbn1cblxuXG5cbmV4cG9ydCBmdW5jdGlvbiBBdHRyaWJ1dGVEZXNjcmlwdG9yKG9wdHM6IElBdHRyaWJ1dGVPcHRpb25zKSB7XG5cblx0cmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQ6YW55LHByb3BlcnR5S2V5OnN0cmluZykge1xuXHRcdE1hbmFnZXIucmVnaXN0ZXJBdHRyaWJ1dGUodGFyZ2V0LHByb3BlcnR5S2V5LG9wdHMpXG5cdH1cblxuXG59XG5cblxuXG5cblxuIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvamdsYW56L0RldmVsb3BtZW50L2R5bm90eXBlL3NyYyJ9
